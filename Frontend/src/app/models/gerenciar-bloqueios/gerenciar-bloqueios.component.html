<div class="gerenciar-bloqueios-container">
  <h2>Meus Horários Bloqueados</h2>

  <div class="filtro-container">
    <app-select
      label="Filtrar por Dia da Semana"
      [options]="diasSemanaOpcoes"
      [(ngModel)]="diaSemanaFiltro"
      (ngModelChange)="onFiltrarDiaSemana()"
      placeholder="Selecione o dia da semana">
    </app-select>
  </div>

  <div class="conteudo">
    <div *ngIf="isLoading">Carregando...</div>
    <div *ngIf="!isLoading && dataSource.data.length === 0">Nenhum horário bloqueado encontrado.</div>

    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z1" *ngIf="!isLoading && dataSource.data.length > 0">
      <!-- Data Column -->
      <ng-container matColumnDef="data">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Data </th>
        <td mat-cell *matCellDef="let bloqueio">{{ formatarData(bloqueio.Data) }}</td>
      </ng-container>

      <!-- Dia da Semana Column -->
      <ng-container matColumnDef="diaSemana">
        <th mat-header-cell *matHeaderCellDef> Dia da Semana </th>
        <td mat-cell *matCellDef="let bloqueio">{{ obterDiaSemana(bloqueio.Data) }}</td>
      </ng-container>

      <!-- Hora Início Column -->
      <ng-container matColumnDef="horaInicio">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Hora Início </th>
        <td mat-cell *matCellDef="let bloqueio">{{ bloqueio.HoraInicio }}</td>
      </ng-container>

      <!-- Hora Fim Column -->
      <ng-container matColumnDef="horaFim">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Hora Fim </th>
        <td mat-cell *matCellDef="let bloqueio">{{ bloqueio.HoraFim }}</td>
      </ng-container>

      <!-- Editar Column -->
      <ng-container matColumnDef="editar">
        <th mat-header-cell *matHeaderCellDef> Editar </th>
        <td mat-cell *matCellDef="let bloqueio">
          <app-button
            [button]="podeEditarOuExcluir(bloqueio) ? 'Editar' : 'Passado'"
            [disabled]="!podeEditarOuExcluir(bloqueio)"
            (clicked)="onEditar(bloqueio)">
          </app-button>
        </td>
      </ng-container>

      <!-- Excluir Column -->
      <ng-container matColumnDef="excluir">
        <th mat-header-cell *matHeaderCellDef> Excluir </th>
        <td mat-cell *matCellDef="let bloqueio">
          <app-button
            [button]="podeEditarOuExcluir(bloqueio) ? 'Excluir' : 'Passado'"
            [disabled]="!podeEditarOuExcluir(bloqueio)"
            (clicked)="onExcluir(bloqueio)">
          </app-button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <mat-paginator
      [pageSize]="10"
      [pageSizeOptions]="[5, 10, 20, 50]"
      *ngIf="dataSource.data.length > 0">
    </mat-paginator>
  </div>
</div>

