<div class="anotacoes-container">
  <h2>Anotações do Psicólogo</h2>

  <div class="filtros">
    <app-input label="Nome do Aluno"
               type="text"
               placeholder="Digite o nome do aluno"
               [value]="nomeAlunoBusca"
               (valueChange)="onBuscaAlunoChange($event)">
    </app-input>

    <div class="lista-alunos"
         *ngIf="alunosFiltrados.length > 0 && mostrarLista">
      <button class="aluno-item"
              *ngFor="let a of alunosFiltrados"
              (click)="selecionarAluno(a)">
        {{ a.nome }}
      </button>
    </div>
  </div>

  <div class="conteudo"
       *ngIf="alunoSelecionadoId">
    <div class="col nova-nota">
      <h3>Nova anotação</h3>

      <app-input label="Data"
                 type="date"
                 placeholder="Selecione a data"
                 [value]="dataNota"
                 (valueChange)="dataNota = $event">
      </app-input>

      <app-input label="Descrição"
                 type="textarea"
                 [rows]="6"
                 placeholder="Escreva sua observação"
                 [value]="descricaoNovaNota"
                 (valueChange)="descricaoNovaNota = $event">
      </app-input>

      <div class="acoes">
        <app-button button="Salvar"
                    (clicked)="criarNota()"></app-button>
      </div>
    </div>

    <div class="col lista-notas">
      <h3>Anotações</h3>

      <div *ngIf="isLoading">Carregando...</div>
      <div *ngIf="!isLoading && dataSource.data.length === 0">Nenhuma anotação encontrada.</div>

      <table mat-table
             [dataSource]="dataSource"
             matSort
             class="mat-elevation-z1"
             *ngIf="dataSource.data.length > 0">
        <!-- Data Column -->
        <ng-container matColumnDef="data">
          <th mat-header-cell
              *matHeaderCellDef
              mat-sort-header> Data </th>
          <td mat-cell
              *matCellDef="let n">{{ formatarData(n.Data) }}</td>
        </ng-container>

        <!-- Dia da Semana Column -->
        <ng-container matColumnDef="diaSemana">
          <th mat-header-cell
              *matHeaderCellDef> Dia da Semana </th>
          <td mat-cell
              *matCellDef="let n">{{ obterDiaSemana(n.Data) }}</td>
        </ng-container>

        <!-- Aluno Column -->
        <ng-container matColumnDef="aluno">
          <th mat-header-cell
              *matHeaderCellDef
              mat-sort-header> Aluno </th>
          <td mat-cell
              *matCellDef="let n">{{ alunoSelecionadoNome }}</td>
        </ng-container>

        <!-- Info Column -->
        <ng-container matColumnDef="info">
          <th mat-header-cell
              *matHeaderCellDef> Info </th>
          <td mat-cell
              *matCellDef="let n">
            <app-button button="Info"
                        (clicked)="onInfo(n)"></app-button>
          </td>
        </ng-container>

        <!-- Editar Column -->
        <ng-container matColumnDef="editar">
          <th mat-header-cell
              *matHeaderCellDef> Editar </th>
          <td mat-cell
              *matCellDef="let n">
            <app-button button="Editar"
                        (clicked)="onEditar(n)"></app-button>
          </td>
        </ng-container>

        <!-- Excluir Column -->
        <ng-container matColumnDef="excluir">
          <th mat-header-cell
              *matHeaderCellDef> Excluir </th>
          <td mat-cell
              *matCellDef="let n">
            <app-button button="Excluir"
                        (clicked)="onExcluir(n)"></app-button>
          </td>
        </ng-container>

        <tr mat-header-row
            *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row
            *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>

      <mat-paginator [pageSize]="5"
                     [pageSizeOptions]="[5, 10, 20]"></mat-paginator>
    </div>
  </div>
</div>
